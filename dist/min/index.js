var e=e=>Object.prototype.toString.call(e),t=t=>"[object Date]"===e(t),n=t=>"[object RegExp]"===e(t),o=t=>"[object Error]"===e(t),r=t=>"[object Boolean]"===e(t),l=t=>"[object Number]"===e(t),i=t=>"[object String]"===e(t),s=Array.isArray,a=Object.getOwnPropertyDescriptor,c=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,p=Object.keys;function h(e){const t=p(e),n=u(e);for(let o=0;o<n.length;o++)c.call(e,n[o])&&t.push(n[o].toString());return t}function y(e,t){return"function"!=typeof a||!a(e,t)?.writable}function b(e){if(!("object"==typeof e&&null!==e&&"buffer"in e&&e.buffer instanceof ArrayBuffer))return!1;const t=Object.prototype.toString.call(e.constructor).match(/\[object (\w+)\]/)[1];return!!["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"].includes(t)}function d(e){if("object"!=typeof e||null===e)return e;let a;if(s(e))a=[];else if(t(e))a=new Date(e.getTime?e.getTime():e);else if(n(e))a=new RegExp(e);else if(o(e))a={message:e.message};else if(r(e)||l(e)||i(e))a=Object(e);else if(b(e))return e.slice()}var v={__proto__:null};function g(e,t,n=v){const o=[],r=[];let l=!0;const i=n.includeSymbols?h:p,a=!!n.immutable;return function e(n){const c=a?d(n):n,u={};let p=!0;const h={node:c,node_:n,path:[].concat(o),parent:r[r.length-1],parents:r,key:o[o.length-1],isRoot:0===o.length,level:o.length,circular:null,update:function(e,t){!h.isRoot&&h.parent&&h.key&&(h.parent.node[h.key]=e),h.node=e,t&&(p=!1)},delete:function(e){delete h.parent?.node[h?.key??""],e&&(p=!1)},remove:function(e){s(h.parent?.node)?h.key&&h.parent.node.splice(+h.key,1):delete h.parent?.node[h.key??""],e&&(p=!1)},keys:null,before:function(e){u.before=e},after:function(e){u.after=e},pre:function(e){u.pre=e},post:function(e){u.post=e},stop:function(){l=!1},block:function(){p=!1}};if(!l)return h;function b(){if("object"==typeof h.node&&null!==h.node){h.keys&&h.node_===h.node||(h.keys=i(h.node)),h.isLeaf=0===h.keys.length;for(let e=0;e<r.length;e++)if(r[e].node_===n){h.circular=r[e];break}}else h.isLeaf=!0,h.keys=null;h.notLeaf=!h.isLeaf,h.notRoot=!h.isRoot}b();const v=t.call(h,h.node);if(void 0!==v&&h.update&&h.update(v),u.before&&u.before.call(h,h.node),!p)return h;if("object"==typeof h.node&&null!==h.node&&!h.circular){r.push(h),b();for(const[t,n]of Object.entries(h.keys??[])){Number(t);o.push(n),u.pre&&u.pre.call(h,h.node[n],n);const r=e(h.node[n]);a&&f.call(h.node,n)&&!y(h.node,n)&&(h.node[n]=r.node),u.post&&u.post.call(h,r),o.pop()}r.pop()}return u.after&&u.after.call(h,h.node),h}(e).node}var m=class{#e;#t;constructor(e,t){this.#e=t??v,this.#t=e}get(e){let t=this.#t;for(let n=0;t&&n<e.length;n++){const o=e[n];if(!f.call(t,o)||!this.#e.includeSymbols&&"symbol"==typeof o)return;t=t[o]}return t}has(e){for(var t=this.#t,n=0;t&&n<e.length;n++){var o=e[n];if(!f.call(t,o)||!this.#e.includeSymbols&&"symbol"==typeof o)return!1;t=t[o]}return!0}set(e,t){for(var n=this.#t,o=0;o<e.length-1;o++){var r=e[o];f.call(n,r)||(n[r]={}),n=n[r]}return n[e[o]]=t,t}map(e){return g(this.#t,e,{__proto__:null,immutable:!0,includeSymbols:!!this.#e.includeSymbols})}forEach(e){return this.#t=g(this.#t,e,this.#e),this.#t}reduce(e,t){var n=1===arguments.length,o=n?this.#t:t;return this.forEach((function(t){this.isRoot&&n||(o=e.call(this,o,t))})),o}paths(){var e=[];return this.forEach((function(){e.push(this.path)})),e}nodes(){var e=[];return this.forEach((function(){e.push(this.node)})),e}clone(){var e=[],t=[],n=this.#e;return b(this.#t)?this.#t.slice():function(o){for(var r=0;r<e.length;r++)if(e[r]===o)return t[r];if("object"==typeof o&&null!==o){var l=d(o);e.push(o),t.push(l);var i=n.includeSymbols?h:p;for(const e of i(o))l[e]=this.clone(o[e]);return e.pop(),t.pop(),l}return o}(this.#t)}};export{m as Traverse};